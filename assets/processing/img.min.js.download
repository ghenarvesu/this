window.onload=function(){function t(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}function k(a){return("0"+a.toString(16)).slice(-2).toUpperCase()}var f=450,g=300,m,b=new Image,n,p;document.getElementById("imageLoader").addEventListener("change",function(a){r.clearRect(0,0,d.width,d.height);var c=new FileReader;c.onload=function(a){b.onload=function(){1.56667>b.width/b.height?f=b.width/b.height*g:g=f/(b.width/b.height);n=b.height;p=b.width;r.drawImage(b,0,0,f,g);
d.addEventListener("mousemove",u,!1);d.addEventListener("mousedown",v,!1);q.addEventListener("mousedown",w,!1);m=!0};b.src=a.target.result};c.readAsDataURL(a.target.files[0])},!1);document.getElementById("webbtn").addEventListener("click",function(){var a=document.getElementById("webImageUrl").value;""!=a&&x(a,function(a){b.src=a;b.onload=function(){1.56667>b.width/b.height?f=b.width/b.height*g:g=f/(b.width/b.height);n=b.height;p=b.width;r.drawImage(b,0,0,f,g);d.addEventListener("mousemove",u,!1);
d.addEventListener("mousedown",v,!1);q.addEventListener("mousedown",w,!1);m=!0}})},!1);var d=document.getElementById("imageCanvas"),r=d.getContext("2d"),q=document.getElementById("pixCanvas"),h=q.getContext("2d");h.imageSmoothingEnabled=!1;h.mozImageSmoothingEnabled=!1;h.webkitImageSmoothingEnabled=!1;var e=document.getElementById("barvaCanvas").getContext("2d"),v=function(a){imageData=h.getImageData(0,0,150,150);a="#"+k(imageData.data[45300])+k(imageData.data[45301])+k(imageData.data[45302]);document.getElementById("pixcolor").value=
a;document.getElementById("pixcolor").select();m=!m;e.beginPath();e.rect(30,30,90,90);e.fillStyle=a;e.fill()},u=function(a){if(m){mousePos=t(d,a);var c=d.clientWidth/d.width;a=q;var l=Math.round(p/f*mousePos.x/c);c=Math.round(n/g*mousePos.y/c);h.clearRect(0,0,a.width,a.height);5>l&&(l=5);5>c&&(c=5);l>p-4&&(l=p-4);c>n-4&&(c=n-4);h.drawImage(b,l-5,c-5,9,9,0,0,a.width,a.height)}},w=function(a){var b=d.clientWidth/d.width;mousePos=t(q,a);imageData=h.getImageData(0,0,150,150);a=600*Math.round(mousePos.y/
b)+4*Math.round(mousePos.x/b);a="#"+k(imageData.data[a+0])+k(imageData.data[a+1])+k(imageData.data[a+2]);document.getElementById("pixcolor").value=a;document.getElementById("pixcolor").select();e.beginPath();e.rect(30,30,90,90);e.fillStyle=a;e.fill()},x=function(a,b){var c=new XMLHttpRequest;c.onload=function(){var a=new FileReader;a.onloadend=function(){b(a.result)};a.readAsDataURL(c.response)};c.open("GET","https://cors-anywhere.herokuapp.com/"+a);c.responseType="blob";c.send()}};